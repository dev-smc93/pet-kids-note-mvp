# 프론트 & 백엔드 구조

## 1. 디렉터리 구조

```
app/
├── (main)/                 # 인증 필요 라우트 그룹
│   ├── layout.tsx          # AuthGuard 적용
│   └── page.tsx            # 홈 (/)
├── auth/                   # 인증 관련 라우트
│   ├── layout.tsx
│   ├── login/page.tsx      # /auth/login
│   ├── signup/page.tsx     # /auth/signup
│   └── profile/page.tsx    # /auth/profile
├── api/
│   └── auth/
│       └── profile/
│           └── route.ts    # GET, POST /api/auth/profile
├── layout.tsx              # 루트 레이아웃 (AuthProvider)
└── globals.css

components/
├── auth/                   # 인증 관련 컴포넌트
│   ├── auth-guard.tsx      # 라우트 보호 (미인증 → 로그인, 프로필 없음 → 프로필 설정)
│   ├── login-form.tsx
│   ├── signup-form.tsx
│   └── profile-form.tsx
├── providers/
│   └── auth-provider.tsx   # AuthProvider 래퍼
└── ui/                     # 재사용 UI
    ├── button.tsx
    └── input.tsx

lib/
├── auth/
│   ├── auth-context.tsx    # Auth 상태, signIn/signUp/signOut
│   └── types.ts
├── supabase/
│   ├── client.ts          # 브라우저용 Supabase 클라이언트
│   ├── server.ts          # 서버용 Supabase 클라이언트
│   └── middleware.ts      # 세션 갱신
└── prisma.ts              # Prisma Client 싱글톤

middleware.ts               # Supabase 세션 갱신 (루트)
prisma/
├── schema.prisma
├── seed.ts
└── migrations/
```

---

## 2. 라우팅 흐름

| 경로 | 접근 | 설명 |
|------|------|------|
| `/` | 인증 + 프로필 필요 | 홈 (AuthGuard) |
| `/auth/login` | 비인증 | 로그인 |
| `/auth/signup` | 비인증 | 회원가입 |
| `/auth/profile` | 인증 필요 | 프로필 설정/수정 |

**리다이렉트 규칙 (AuthGuard)**
- 미인증 + `/` 접근 → `/auth/login`
- 인증 + 프로필 없음 + `/` 접근 → `/auth/profile`

---

## 3. API 구조

| 메서드 | 경로 | 설명 |
|--------|------|------|
| GET | `/api/auth/profile` | 현재 사용자 프로필 조회 |
| POST | `/api/auth/profile` | 프로필 생성/수정 (name, role) |

---

## 4. 인증 흐름

```
[회원가입] → Supabase Auth signUp → /auth/profile (프로필 설정)
[로그인]   → Supabase Auth signIn → / (홈)
[로그아웃] → Supabase Auth signOut
[프로필]   → POST /api/auth/profile → profiles 테이블
```

---

## 5. 기술 스택

| 구분 | 기술 |
|------|------|
| Auth | Supabase Auth |
| DB | Supabase Postgres + Prisma |
| UI | React, Tailwind CSS |
| Framework | Next.js 16 (App Router) |
